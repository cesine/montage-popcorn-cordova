montageDefine("c827d65","ui/flow.reel/flow-translate-composer",{dependencies:["montage","composer/translate-composer","core/event/event-manager","core/geometry/point","core/dom"],factory:function(e,t){var n=(e("montage").Montage,e("composer/translate-composer").TranslateComposer),r=(e("core/event/event-manager").defaultEventManager,e("core/geometry/point").Point),i=e("core/dom").convertPointFromPageToNode;t.FlowTranslateComposer=n.specialize({_scrollingMode:{value:"linear"},scrollingMode:{get:function(){return this._scrollingMode},set:function(e){switch(e){case"linear":case"drag":this._scrollingMode=e}}},_linearScrollingVector:{value:[-300,0]},linearScrollingVector:{get:function(){return this._linearScrollingVector},set:function(e){this._linearScrollingVector=e}},_startPageX:{value:null},_startPageY:{value:null},_pageX:{value:null},_pageY:{value:null},_pointerStartX:{value:null},_pointerStartY:{value:null},_contentOffsetX:{value:null},_contentOffsetY:{value:null},_start:{value:function(e,t){n._start.apply(this,arguments);var a=window.getComputedStyle(this._element,null),o=this.convertCssPixelsPropertyStringToNumber(a.getPropertyValue("border-left-width")),s=this.convertCssPixelsPropertyStringToNumber(a.getPropertyValue("border-top-width")),l=this.convertCssPixelsPropertyStringToNumber(a.getPropertyValue("padding-left")),u=this.convertCssPixelsPropertyStringToNumber(a.getPropertyValue("padding-top")),c=i(this._element,(new r).init(e,t));this._pointerStartX=this._pointerX=c.x-o-l,this._pointerStartY=this._pointerY=c.y-s-u,this._contentOffsetX=this._startPageX-this._pointerStartX,this._contentOffsetY=this._startPageY-this._pointerStartY,this._computePointedElement(),this._startPageX=this._pageX=e,this._startPageY=this._pageY=t,this._startScroll=this._scroll,this._previousScrollDelta=0,this._scrollEnd=null}},_analyzeMovement:{value:function(e){var t,n,r,i=e.velocity;i&&(t=i.speed,t>=this.startTranslateSpeed?this._stealPointer():(n=this.startPageX-e.pageX,r=this.startPageY-e.pageY,n*n+r*r>this.startTranslateRadius*this.startTranslateRadius&&this._stealPointer()))}},_dispatchTranslateStart:{value:function(){var e=document.createEvent("CustomEvent");e.initCustomEvent("translateStart",!0,!0,null),e.scroll=this._scroll,this.dispatchEvent(e)}},_dispatchTranslateEnd:{value:function(){var e=document.createEvent("CustomEvent");e.initCustomEvent("translateEnd",!0,!0,null),e.scroll=this._scroll,this.dispatchEvent(e)}},_dispatchTranslate:{value:function(){var e=document.createEvent("CustomEvent");e.initCustomEvent("translate",!0,!0,null),e.scroll=this._scroll,this.dispatchEvent(e)}},_move:{value:function(e,t){this._isFirstMove&&(this._dispatchTranslateStart(),this._isFirstMove=!1),this._pageX=e,this._pageY=t,"drag"===this._scrollingMode?(this._pointerX=e-this._contentOffsetX,this._pointerY=t-this._contentOffsetY,this._updateDragScroll()):this._updateLinearScroll(),null!==this._closerIndex,this._shouldDispatchTranslate&&this._dispatchTranslate()}},_end:{value:function(e){this.startTime=Date.now(),this.endX=this.startX=this._pageX,this.endY=this.startY=this._pageY,this._hasMomentum&&(e.velocity.speed>40||this.translateStrideX||this.translateStrideY)?(this.momentumX="vertical"!=this._axis?e.velocity.x*this._pointerSpeedMultiplier*(this._invertXAxis?1:-1):0,this.momentumY="horizontal"!=this._axis?e.velocity.y*this._pointerSpeedMultiplier*(this._invertYAxis?1:-1):0,this.endX=this.startX+this.momentumX*this.__momentumDuration/2e3,this.endY=this.startY+this.momentumY*this.__momentumDuration/2e3,this.startStrideXTime=null,this.startStrideYTime=null,this.animateMomentum=!0):this.animateMomentum=!1,this.animateMomentum?this._animationInterval():this._isFirstMove||this._dispatchTranslateEnd(),this._releaseInterest()}},handleMousewheel:{value:function(){}},_scroll:{value:0},scroll:{get:function(){return this._scroll},set:function(e){null!==this.minScroll&&this.minScroll>e&&(e=this.minScroll),null!==this.maxScroll&&e>this.maxScroll&&(e=this.maxScroll),this._scroll=e}},minScroll:{value:null},maxScroll:{value:null},_flow:{value:null},flow:{get:function(){return this._flow},set:function(e){this._flow=e,this.component=e}},_updateScroll:{value:function(){"linear"===this._scrollingMode?this._updateLinearScroll():this._updateDragScroll()}},_updateLinearScroll:{value:function(){var e=500/this._flow._height,t=(this._pageX-this._startPageX)*this._linearScrollingVector[0]*e,n=(this._pageY-this._startPageY)*this._linearScrollingVector[1]*e,r=this._linearScrollingVector[0]*this._linearScrollingVector[0]+this._linearScrollingVector[1]*this._linearScrollingVector[1],i=(t+n)/r;this.scroll+=i-this._previousScrollDelta,this._previousScrollDelta=i}},_updateDragScroll:{value:function(){var e=(this._pointerX-this._pointerStartX)*this._lineVectorX,t=(this._pointerY-this._pointerStartY)*this._lineVectorY,n=this._lineVectorX*this._lineVectorX+this._lineVectorY*this._lineVectorY,r=(e+t)/n;this.scroll+=r-this._previousScrollDelta,this._previousScrollDelta=r;var i,a,o,s,l,u,c,h,d,p,f,m,v,g,b,_,y,w,x,E,S=this._flow,C=S._cameraPosition,T=S._splinePaths,O=T.length,k=this._closerIndex%O,P=this.flow._splinePaths[k],M=Math.floor(this._closerIndex/O)-this._scroll+this._flow._paths[k].headOffset,D=null,j=null,L=0,A=.5*this._element.clientWidth,I=.5*this._element.clientHeight,e=A-this._pointerX,t=I-this._pointerY,R=S.cameraTargetPoint[0]-C[0],B=S.cameraTargetPoint[1]-C[1],z=S.cameraTargetPoint[2]-C[2],N=-Math.atan2(R,z),F=this._pointerIntersectionPosition;f=z*Math.cos(N)-R*Math.sin(N),m=-Math.atan2(B,f),_=Math.sin(N),y=Math.cos(N),w=Math.sin(m),x=Math.cos(m),g=I/Math.tan(.008726646259972*S.cameraFov),E=0,c=1e100;do p=P._convertSplineTimeToBezierIndexTime(M+E),null!==p&&(i=P.getPositionAtIndexTime(p),rotation=T[k].getRotationAtIndexTime(p),v=this._rotateXYZ(F,rotation),a=(C[2]-i[2]-v[2])*_-(i[0]-C[0]+v[0])*y,o=i[1]-C[1]+v[1],s=(i[2]-C[2]+v[2])*y-(i[0]-C[0]+v[0])*_,l=s*w+o*x,u=s*x-o*w,b=g/u,a=e+a*b,o=t+l*b,d=a*a+o*o,c>d&&(c=d,D=E)),E-=.025;while(E>-6);D+.025>0&&(D=-.025),E=D+.025,c=1e100;do p=P._convertSplineTimeToBezierIndexTime(M+E),null!==p&&(i=P.getPositionAtIndexTime(p),rotation=T[k].getRotationAtIndexTime(p),v=this._rotateXYZ(F,rotation),a=(C[2]-i[2]-v[2])*_-(i[0]-C[0]+v[0])*y,o=i[1]-C[1]+v[1],s=(i[2]-C[2]+v[2])*y-(i[0]-C[0]+v[0])*_,l=s*w+o*x,u=s*x-o*w,b=g/u,a=e+a*b,o=t+l*b,d=a*a+o*o,c>d&&(c=d,D=E)),E-=2e-4;while(E>D-.05);E=0,h=1e100;do p=P._convertSplineTimeToBezierIndexTime(M+E),null!==p&&(i=P.getPositionAtIndexTime(p),rotation=T[k].getRotationAtIndexTime(p),v=this._rotateXYZ(F,rotation),a=(C[2]-i[2]-v[2])*_-(i[0]-C[0]+v[0])*y,o=i[1]-C[1]+v[1],s=(i[2]-C[2]+v[2])*y-(i[0]-C[0]+v[0])*_,l=s*w+o*x,u=s*x-o*w,b=g/u,a=e+a*b,o=t+l*b,d=a*a+o*o,h>d&&(h=d,j=E)),E+=.025;while(6>E);0>j-.025&&(j=.025),E=j-.025,h=1e100;do p=P._convertSplineTimeToBezierIndexTime(M+E),null!==p&&(i=P.getPositionAtIndexTime(p),rotation=T[k].getRotationAtIndexTime(p),v=this._rotateXYZ(F,rotation),a=(C[2]-i[2]-v[2])*_-(i[0]-C[0]+v[0])*y,o=i[1]-C[1]+v[1],s=(i[2]-C[2]+v[2])*y-(i[0]-C[0]+v[0])*_,l=s*w+o*x,u=s*x-o*w,b=g/u,a=e+a*b,o=t+l*b,d=a*a+o*o,h>d&&(h=d,j=E)),E+=2e-4;while(j+.05>E);D?L=j?j*j>D*D?D:j:D:j&&(L=j),L>0?.05>=L&&(this.scroll=this._scroll-L):L>=-.05&&(this.scroll=this._scroll-L)}},frame:{value:function(){this.isAnimating&&this._animationInterval()}},convertCssPixelsPropertyStringToNumber:{value:function(e){return"string"==typeof e?"px"===e.substr(-2)?1*e.substr(0,e.length-2):0:0}},_rayRectangleIntersection:{value:function(e,t,n,r){var i,a,o,s,l,u=e[1]*r[2]-e[2]*r[1],c=e[2]*r[0]-e[0]*r[2],h=e[0]*r[1]-e[1]*r[0],d=n[0]*u+n[1]*c+n[2]*h,p=1e-10,f=!1;return-p>d?(i=-t[0]*u-t[1]*c-t[2]*h,0>i&&i>d&&(o=n[1]*t[2]-n[2]*t[1],s=n[2]*t[0]-n[0]*t[2],l=n[0]*t[1]-n[1]*t[0],a=e[0]*o+e[1]*s+e[2]*l,0>a&&a>d&&(f=(r[0]*o+r[1]*s+r[2]*l)/d,0>f&&(f=!1)))):d>p&&(i=-t[0]*u-t[1]*c-t[2]*h,i>0&&d>i&&(o=n[1]*t[2]-n[2]*t[1],s=n[2]*t[0]-n[0]*t[2],l=n[0]*t[1]-n[1]*t[0],a=e[0]*o+e[1]*s+e[2]*l,a>0&&d>a&&(f=(r[0]*o+r[1]*s+r[2]*l)/d,0>f&&(f=!1)))),f}},_rayRectangleIntersectionPosition:{enumerable:!1,value:function(e,t,n,r){var i,a,o,s,l,u=e[1]*r[2]-e[2]*r[1],c=e[2]*r[0]-e[0]*r[2],h=e[0]*r[1]-e[1]*r[0],d=n[0]*u+n[1]*c+n[2]*h,p=this._flow._boundingBoxSize;return i=-t[0]*u-t[1]*c-t[2]*h,o=n[1]*t[2]-n[2]*t[1],s=n[2]*t[0]-n[0]*t[2],l=n[0]*t[1]-n[1]*t[0],a=e[0]*o+e[1]*s+e[2]*l,[i*p[0]/d-.5*p[0],a*p[1]/d-.5*p[1],0]}},_rotateXYZ:{enumerable:!1,value:function(e,t){var n,r,i,a,o=Math.cos(t[0]),s=Math.sin(t[0]),l=Math.cos(t[1]),u=Math.sin(t[1]),c=Math.cos(t[2]),h=Math.sin(t[2]);return r=o*e[1]-s*e[2],i=s*e[1]+o*e[2],a=l*e[0]+u*i,i=-u*e[0]+l*i,n=c*a-h*r,r=h*a+c*r,[n,r,i]}},_pointerIntersectionPosition:{enumerable:!1,value:null},_closerIndex:{enumerable:!1,value:null},_computePointedElement:{value:function(){var e=this._flow._splinePaths,t=e.length;if(t){var n,r,i,a,o,s,l,u,c,h,d,p,f,m=this._flow,v=m.cameraTargetPoint[0]-m.cameraPosition[0],g=m.cameraTargetPoint[2]-m.cameraPosition[2],b=Math.atan2(v,g),_=g*Math.cos(-b)-v*Math.sin(-b),y=Math.atan2(m.cameraTargetPoint[1]-m.cameraPosition[1],_),w=.5*this._element.clientWidth-this._pointerX,x=this._pointerY-.5*this._element.clientHeight,E=.5*this._element.offsetHeight/Math.tan(m.cameraFov*m._doublePI*(1/720)),S=[],C=m._visibleIndexes,T=C.length,O=null,k=1e100;for(r=E*Math.cos(y)-x*Math.sin(y),x=E*Math.sin(y)+x*Math.cos(y),n=r*Math.cos(b)-w*Math.sin(b),w=r*Math.sin(b)+w*Math.cos(b),d=[w,x,n],f=0;e.length>f;f++)S[f]=e[f].transform([1,0,0,0,0,1,0,0,0,0,1,0,-m.cameraPosition[0],-m.cameraPosition[1],-m.cameraPosition[2],1]);for(f=0;T>f;f++)p=this._flow.offset(C[f]),i=p.pathIndex,a=p.slideTime,s=S[i]._convertSplineTimeToBezierIndexTime(a),null!==s&&(pos=S[i].getPositionAtIndexTime(s),l=e[i].getRotationAtIndexTime(s),c=this._rotateXYZ([m.boundingBoxSize[0],0,0],l),h=this._rotateXYZ([0,m.boundingBoxSize[1],0],l),u=[pos[0]-.5*(c[0]+h[0]),pos[1]-.5*(c[1]+h[1]),pos[2]-.5*(c[2]+h[2])],(o=this._rayRectangleIntersection(d,u,c,h))&&k>o&&(k=o,O=C[f],this._pointerIntersectionPosition=this._rayRectangleIntersectionPosition(d,u,c,h)));this._closerIndex=O}}},test:{enumerable:!1,value:function(){var e,t,n,r,i,a,o,s,l,u,c=this._flow,h=this._bezierValue,d=c.cameraTargetPoint[0]-c.cameraPosition[0],p=c.cameraTargetPoint[1]-c.cameraPosition[1],f=c.cameraTargetPoint[2]-c.cameraPosition[2],m=Math.atan2(d,f),v=this._pointerX,g=this._pointerY;if(e=f*Math.cos(-m)-d*Math.sin(-m),t=Math.atan2(p,e),r=.5*this._element.clientWidth-v,i=g-.5*this._element.clientHeight,u=a=.5*this._element.offsetHeight/Math.tan(c.cameraFov*c._doublePI*(1/720)),l=a*Math.cos(t)-i*Math.sin(t),s=a*Math.sin(t)+i*Math.cos(t),o=r,a=l*Math.cos(m)-o*Math.sin(m),r=l*Math.sin(m)+o*Math.cos(m),i=s,this.t=n=this._raycastBezierTubes(c._cameraPosition[0],c._cameraPosition[1],c._cameraPosition[2],this._computeRotationValuesToXAxis(r,i,a)),null!==n[0]){var r,i,a,o,s,l,b,_,y,w,x,E=[c._splinePaths[n[0]]._knots[n[1]][0]-c._cameraPosition[0],c._splinePaths[n[0]]._knots[n[1]][1]-c._cameraPosition[1],c._splinePaths[n[0]]._knots[n[1]][2]-c._cameraPosition[2],c._splinePaths[n[0]]._nextHandlers[n[1]][0]-c._cameraPosition[0],c._splinePaths[n[0]]._nextHandlers[n[1]][1]-c._cameraPosition[1],c._splinePaths[n[0]]._nextHandlers[n[1]][2]-c._cameraPosition[2],c._splinePaths[n[0]]._previousHandlers[n[1]+1][0]-c._cameraPosition[0],c._splinePaths[n[0]]._previousHandlers[n[1]+1][1]-c._cameraPosition[1],c._splinePaths[n[0]]._previousHandlers[n[1]+1][2]-c._cameraPosition[2],c._splinePaths[n[0]]._knots[n[1]+1][0]-c._cameraPosition[0],c._splinePaths[n[0]]._knots[n[1]+1][1]-c._cameraPosition[1],c._splinePaths[n[0]]._knots[n[1]+1][2]-c._cameraPosition[2]],S=[];for(x=0;12>x;x+=3)S[0]=E[x+2]*Math.sin(-m)+E[x]*Math.cos(-m),S[1]=E[x+1],S[2]=E[x+2]*Math.cos(-m)-E[x]*Math.sin(-m),E[x]=S[0],E[x+1]=S[2]*Math.sin(-t)+S[1]*Math.cos(-t),E[x+2]=S[2]*Math.cos(-t)-S[1]*Math.sin(-t);a=h(E[2],E[5],E[8],E[11],n[2]),l=h(E[2],E[5],E[8],E[11],n[2]+1e-8),r=h(E[0],E[3],E[6],E[9],n[2])/a,o=h(E[0],E[3],E[6],E[9],n[2]+1e-8)/l,b=(o-r)*u/1e-8,i=h(E[1],E[4],E[7],E[10],n[2])/a,s=h(E[1],E[4],E[7],E[10],n[2]+1e-8)/l,dy=(s-i)*u/1e-8,_=Math.sqrt(b*b+dy*dy),y=Math.atan2(dy,b),w=c._splinePaths[n[0]]._densities[n[1]]*(1-n[2])+c._splinePaths[n[0]]._densities[n[1]+1]*n[2],this._lineVectorX=Math.cos(-y)*_/w,this._lineVectorY=Math.sin(-y)*_/w}}},_lineVectorX:{enumerable:!1,value:80*Math.cos(Math.PI-.6)},_lineVectorY:{enumerable:!1,value:80*Math.sin(Math.PI-.6)},_startX:{enumerable:!1,value:0},_startY:{enumerable:!1,value:0},_currentX:{enumerable:!1,value:0},_currentY:{enumerable:!1,value:0},_previousScrollDelta:{enumerable:!1,value:0},_startScroll:{enumerable:!1,value:0},_bezierValue:{enumerable:!1,value:function(e,t,n,r,i){var a=1-i;return e*a*a*a+3*t*a*a*i+3*n*a*i*i+r*i*i*i}},_computeRotationValuesToXAxis:{enumerable:!1,value:function(e,t,n){var r,i,a,o,s;return 1e-100>e*e&&(e=1e-50),r=e*e+t*t,i=Math.sqrt(r),a=1/i,s=e*a,o=-t*a,a=1/Math.sqrt(r+n*n),[o,s,-n*a,i*a]}},_infinite:{enumerable:!1,value:1e100},_sphereIntersection:{enumerable:!1,value:function(e,t){var n,r,i,a=e[0]*t[1]-e[1]*t[0],o=e[0]*t[0]+e[1]*t[1],s=a*t[2]+e[2]*t[3],l=e[3]*e[3];return l>=o*o+s*s?(n=a*t[3]-e[2]*t[2],r=Math.sqrt(l-o*o-s*s),i=n-r,0>i?0>n+r?this._infinite:0:i):this._infinite}},_bezierTubeBoundingSphere:{enumerable:!1,value:function(e,t){var n,r,i,a,o,s=e[0],l=e[1],u=e[2],c=e[0],h=e[1],d=e[2];return o=e[3],s>o?s=o:o>c&&(c=o),o=e[4],l>o?l=o:o>h&&(h=o),o=e[5],u>o?u=o:o>d&&(d=o),o=e[6],s>o?s=o:o>c&&(c=o),o=e[7],l>o?l=o:o>h&&(h=o),o=e[8],u>o?u=o:o>d&&(d=o),o=e[9],s>o?s=o:o>c&&(c=o),o=e[10],l>o?l=o:o>h&&(h=o),o=e[11],u>o?u=o:o>d&&(d=o),n=.5*(c-s),r=.5*(h-l),i=.5*(d-u),a=Math.sqrt(n*n+r*r+i*i)+t,[s+n,l+r,u+i,a]}},_raycastBezierTubes:{enumerable:!1,value:function(e,t,n,r){var i,a,o,s,l,u,c,h,d,p,f,m,v,g,b,_,y,w,x,E,S,C,T,O,k,P,M,D,j=[],L=this._infinite,A=null,I=0,R=null,B=0,z=this._flow._splinePaths;for(D=0;z.length>D;D++)for(M=0;z[D]._knots.length-1>M;M++)j[B]=[z[D]._knots[M][0]-e,z[D]._knots[M][1]-t,z[D]._knots[M][2]-n,z[D]._nextHandlers[M][0]-e,z[D]._nextHandlers[M][1]-t,z[D]._nextHandlers[M][2]-n,z[D]._previousHandlers[M+1][0]-e,z[D]._previousHandlers[M+1][1]-t,z[D]._previousHandlers[M+1][2]-n,z[D]._knots[M+1][0]-e,z[D]._knots[M+1][1]-t,z[D]._knots[M+1][2]-n,0,1048576,M,D],B++;for(M=B-1;M>=0;)c=j[M],h=.5*(c[0]+c[3]),d=.5*(c[3]+c[6]),p=.5*(c[6]+c[9]),g=.5*(c[1]+c[4]),b=.5*(c[4]+c[7]),_=.5*(c[7]+c[10]),E=.5*(c[2]+c[5]),S=.5*(c[5]+c[8]),C=.5*(c[8]+c[11]),f=.5*(h+d),m=.5*(d+p),v=.5*(f+m),y=.5*(g+b),w=.5*(b+_),x=.5*(y+w),T=.5*(E+S),O=.5*(S+C),k=.5*(T+O),P=c[13]>>1,o=[c[0],c[1],c[2],h,g,E,f,y,T,v,x,k,c[12],P,c[14],c[15]],i=this._bezierTubeBoundingSphere(o,this._flow._elementsBoundingSphereRadius),s=[v,x,k,m,w,O,p,_,C,c[9],c[10],c[11],c[12]+P,P,c[14],c[15]],a=this._bezierTubeBoundingSphere(s,this._flow._elementsBoundingSphereRadius),l=this._sphereIntersection(i,r),u=this._sphereIntersection(a,r),L>l?L>u?u>l?P?(j[M++]=s,j[M]=o):(L=l-1e-5,I=c[12],A=c[14],R=c[15],M--):P?(j[M++]=o,j[M]=s):(L=u-1e-5,I=c[12],A=c[14],R=c[15],M--):P?j[M]=o:(L=l-1e-5,I=c[12],A=c[14],R=c[15],M--):L>u?P?j[M]=s:(L=u-1e-5,I=c[12],A=c[14],R=c[15],M--):M--;return[R,A,I*(1/1048576)]}},_translateStride:{enumerable:!1,value:null},translateStride:{serializable:!0,get:function(){return this._translateStride},set:function(e){this._translateStride=e,this.translateStrideX=e}},startStrideTime:{enumerable:!1,value:null},_scrollEnd:{enumerable:!1,value:null},_scrollStart:{enumerable:!1,value:null},_hasMomentum:{enumerable:!1,value:!0},_animationInterval:{enumerable:!1,value:function(){var e,t,n,r,i,a,o=Date.now(),s=!1;i=this.minScroll,a=this.maxScroll,this.minScroll=null,this.maxScroll=null,null===this._scrollEnd&&(this._scrollStart=this.scroll,this._pageX=this.endX,this._pageY=this.endY,this._updateScroll(),this._scrollEnd=this.scroll,this._pageX=this.startX,this._pageY=this.startY,this._updateScroll()),this.animateMomentum?(e=o-this.startTime,this.__momentumDuration>e?(this._pageX=this.startX+(this.momentumX+this.momentumX*(this.__momentumDuration-e)/this.__momentumDuration)*e/1e3/2,this._pageY=this.startY+(this.momentumY+this.momentumY*(this.__momentumDuration-e)/this.__momentumDuration)*e/1e3/2,this._updateScroll(),this.translateStrideX&&null===this.startStrideXTime&&(this.__momentumDuration-e<this.translateStrideDuration||Math.abs(this.scroll-this._scrollEnd)<.75*this.translateStrideX)&&(this.startStrideXTime=o,this._strideStartScroll=this._scroll)):this.animateMomentum=!1):null===this.startStrideXTime&&(this.startStrideXTime=this.startTime,this._strideStartScroll=this._scrollStart),r=this.scroll,this.startStrideXTime&&o-this.startStrideXTime>0&&(n=Math.round(this._scrollEnd/this.translateStrideX),o-this.startStrideXTime<this.translateStrideDuration?(e=this._bezierTValue((o-this.startStrideXTime)/this.translateStrideDuration,.275,0,.275,1),t=(o-this.startStrideXTime)/this.translateStrideDuration,r=r*(1-t)+(n*this.translateStrideX*e+this._strideStartScroll*(1-e))*t,s=!0):r=n*this.translateStrideX),this.minScroll=i,this.maxScroll=a,i>r&&(r=i,this.animateMomentum=!1,s=!1),r>a&&(r=a,this.animateMomentum=!1,s=!1),this.scroll=r,this.isAnimating=this.animateMomentum||s,this.isAnimating?this.needsFrame=!0:(this._dispatchTranslateEnd(),this._scrollEnd=null)}}})}}),montageDefine("1aa7581","ui/scroll-bars.reel/scroll-bars",{dependencies:["montage/ui/component"],factory:function(e,t){var n=e("montage/ui/component").Component;t.ScrollBars=n.specialize({_verticalScroll:{value:0},_horizontalScroll:{value:0},_verticalLength:{value:0},_horizontalLength:{value:0},verticalScroll:{get:function(){return this._verticalScroll},set:function(e){this._verticalScroll=e,this.needsDraw=!0}},horizontalScroll:{get:function(){return this._horizontalScroll},set:function(e){this._horizontalScroll=e,this.needsDraw=!0}},verticalLength:{get:function(){return this._verticalLength},set:function(e){this._verticalLength=e,this.needsDraw=!0}},horizontalLength:{get:function(){return this._horizontalLength},set:function(e){this._horizontalLength=e,this.needsDraw=!0}},_opacity:{value:0},opacity:{get:function(){return this._opacity},set:function(e){this._opacity=e,this.needsDraw=!0}},_isDisplayUpdated:{value:!1},_displayVertical:{value:!1},displayVertical:{get:function(){return this._displayVertical},set:function(e){this._displayVertical!==e&&(this._displayVertical=e,this._isDisplayUpdated=!0,this.needsDraw=!0)}},_displayHorizontal:{value:!1},displayHorizontal:{get:function(){return this._displayHorizontal},set:function(e){this._displayHorizontal!==e&&(this._displayHorizontal=e,this._isDisplayUpdated=!0,this.needsDraw=!0)}},_top:{value:!1},_bottomClip:{value:!1},_bottom:{value:!1},_left:{value:!1},_rightClip:{value:!1},_right:{value:!1},_hasResizedHorizontal:{value:!1},_hasResizedVertical:{value:!1},willDraw:{value:function(){this._offsetWidth!==this._element.offsetWidth&&(this._offsetWidth=this._element.offsetWidth,this._hasResizedHorizontal=!0),this._offsetHeight!==this._element.offsetHeight&&(this._offsetHeight=this._element.offsetHeight,this._hasResizedVertical=!0)}},draw:{value:function(){var e,t,n,r;if(this._isDisplayUpdated){var i=this._displayVertical?"block":"none",a=this._displayHorizontal?"block":"none";this._top.style.display=this._bottomClip.style.display=i,this._left.style.display=this._rightClip.style.display=a,this._isDisplayUpdated=!1}if(this._hasResizedHorizontal&&this._displayHorizontal&&(this._rightClip.style.width=this._right.style.width=this._offsetWidth-4+"px",this._rightClip.style.clip="rect(-1px,"+(this._offsetWidth-3)+"px,6px,3px)",this._hasResizedHorizontal=!1),this._hasResizedVertical&&this._displayVertical&&(this._bottomClip.style.height=this._bottom.style.height=this._offsetHeight-4+"px",this._bottomClip.style.clip="rect(3px,6px,"+(this._offsetHeight-3)+"px,-1px)",this._hasResizedVertical=!1),this._opacity){if(this._displayHorizontal){n=this._offsetWidth-9-(this._displayVertical?6:0),e=Math.floor(n*this._horizontalLength),r=n-e,t=1-this._horizontalLength?Math.floor(r*this._horizontalScroll/(1-this._horizontalLength)):0,0>t&&(e+=t,0>e&&(e=0),t=0),t>r&&(e+=Math.floor(r-t),0>e&&(e=0),t=n-e);var o=e-this._offsetWidth+9+"px,0px",s=t+2+"px,0px";this._right.style.webkitTransform="translate3d("+o+",0)",this._right.style.MozTransform="translate("+o+")",this._right.style.transform="translate("+o+")",this._left.style.webkitTransform=this._rightClip.style.webkitTransform="translate3d("+s+",0)",this._left.style.MozTransform=this._rightClip.style.MozTransform="translate("+s+")",this._left.style.transform=this._rightClip.style.transform="translate("+s+")",this._left.style.webkitTransition=this._right.style.webkitTransition="none",this._left.style.MozTransition=this._right.style.MozTransition="none",this._left.style.transition=this._right.style.transition="none",this._left.style.opacity=this._right.style.opacity=this._opacity}if(this._displayVertical){n=this._offsetHeight-9-(this._displayHorizontal?6:0),e=Math.floor(n*this._verticalLength),r=n-e,t=1-this._verticalLength?Math.floor(r*this._verticalScroll/(1-this._verticalLength)):0,0>t&&(e+=t,0>e&&(e=0),t=0),t>r&&(e+=Math.floor(r-t),0>e&&(e=0),t=n-e);var l="0px,"+(e-this._offsetHeight+9)+"px",u="0px,"+(t+2)+"px";this._bottom.style.webkitTransform="translate3d("+l+",0)",this._bottom.style.MozTransform="translate("+l+")",this._bottom.style.transform="translate("+l+")",this._top.style.webkitTransform=this._bottomClip.style.webkitTransform="translate3d("+u+",0)",this._top.style.MozTransform=this._bottomClip.style.MozTransform="translate("+u+")",this._top.style.transform=this._bottomClip.style.transform="translate("+u+")",this._top.style.webkitTransition=this._bottom.style.webkitTransition="none",this._top.style.MozTransition=this._bottom.style.MozTransition="none",this._top.style.transition=this._bottom.style.transition="none",this._top.style.opacity=this._bottom.style.opacity=this._opacity}}else this._displayHorizontal&&(this._left.style.webkitTransition=this._right.style.webkitTransition="300ms opacity",this._left.style.opacity=this._right.style.opacity=0),this._displayVertical&&(this._top.style.webkitTransition=this._bottom.style.webkitTransition="300ms opacity",this._top.style.opacity=this._bottom.style.opacity=0)}}})}}),montageDefine("e0871b3","ui/details.reel/details.html",{text:'<!DOCTYPE html>\n\n<html>\n<head>\n    <link rel=stylesheet type=text/css href=details.css>\n\n    <script type=text/montage-serialization>{"title":{"prototype":"montage/ui/text.reel","properties":{"element":{"#":"title"}},"bindings":{"value":{"<-":"@owner.data.title"}}},"description":{"prototype":"montage/ui/text.reel","properties":{"element":{"#":"description"}},"bindings":{"value":{"<-":"@owner.data.synopsis"}}},"dates":{"prototype":"montage/ui/text.reel","properties":{"element":{"#":"dates-content"}},"bindings":{"value":{"<-":"@owner.data.release_dates.theater"}}},"runtime":{"prototype":"montage/ui/text.reel","properties":{"element":{"#":"runtime-content"}},"bindings":{"value":{"<-":"@owner.data.runtime"}}},"rentButton":{"prototype":"matte/ui/button.reel","properties":{"element":{"#":"rent-button"}},"listeners":[{"type":"action","listener":{"@":"owner"}}]},"trailerButton":{"prototype":"matte/ui/button.reel","properties":{"element":{"#":"trailer-button"}},"listeners":[{"type":"action","listener":{"@":"owner"}}]},"audienceScore":{"prototype":"montage/ui/text.reel","properties":{"element":{"#":"audience-score-content"}},"bindings":{"value":{"<-":"@owner.data.ratings.audience_score"}}},"criticsScore":{"prototype":"montage/ui/text.reel","properties":{"element":{"#":"critics-score-content"}},"bindings":{"value":{"<-":"@owner.data.ratings.critics_score"}}},"scroller":{"prototype":"matte/ui/scroller.reel","properties":{"element":{"#":"scroller"},"hasMomentum":true}},"owner":{"properties":{"element":{"#":"details"},"cImage":{"#":"c-image"},"aImage":{"#":"a-image"}}}}</script>\n</head>\n<body>\n    <div data-montage-id=details class=details>\n      <div data-montage-id=moviepopup-container class=moviepopup-container>\n\n          <section>\n              <h2 data-montage-id=title class=title></h2>\n              <p>\n                  <time data-montage-id=dates-content class=score></time>\n                  Runtime <span data-montage-id=runtime-content class=score></span>\n                  Audience <span data-montage-id=a-image class="rt-icon icon-audience"></span>\n                           <span data-montage-id=audience-score-content class=score></span>\n                  Critics <span data-montage-id=c-image class="rt-icon icon-critics"></span>\n                          <span data-montage-id=critics-score-content class=score></span>\n              </p>\n              <div data-montage-id=scroller class=scroller>\n                  <p data-montage-id=description class=description></p>\n              </div>\n          </section>\n\n          <nav class=action-buttons>\n              <button data-montage-id=trailer-button class="button button-trailer">Trailer</button>\n              <button data-montage-id=rent-button class="button button-rent">Rent</button>\n          </nav>\n\n      </div>\n    </div>\n</body>\n</html>'}),montageDefine("bbf3eb6","package.json",{exports:{name:"native",version:"0.1.1-alpha",publishConfig:{tag:"edge"},repository:{type:"git",url:"https://github.com/montagejs/native.git"},dependencies:{montage:"0.13.0-alpha"},devDependencies:{"montage-testing":"0.2.0-alpha"},exclude:["overview.html","overview","run-tests.html","test"],readme:'montage-native\n==============\n\nThis is the Montage package template.\n\nNote: Before working on your package you will need to add montage to it.\n\n```\nnpm install .\n```\n\nLayout\n------\n\nThe template contains the following files and directories:\n\n* `ui/` – Directory containing all the UI .reel directories.\n* `package.json` – Describes your app and its dependencies\n* `README.md` – This readme. Replace the current content with a description of your app\n* `overview.html`\n* `overview/` – Directory that contains the files for the overview page. This is a different package so you will need to require the component using montage-native/*.\n  * `main.reel` – The main interface component where you can add the components to show.\n* `node_modules/` – Directory containing all npm packages needed, including Montage. Any packages here must be included as `dependencies` in `package.json` for the Montage require to find them.\n* `test/` – Directory containing tests for your package.\n  * `all.js` – Module that point the test runner to all your jasmine specs.\n* `run-tests.html` – Page to run jasmine tests manually in your browser\n* `testacular.conf.js` – This is the testacular configuration file. You can start testacular by running `node_modules/testacular/bin/testacular start`\n\nCreate the following directories if you need them:\n\n* `locale/` – Directory containing localized content.\n* `scripts/` – Directory containing other JS libraries. If a library doesn’t support the CommonJS "exports" object it will need to be loaded through a `<script>` tag.\n\n',readmeFilename:"README.md",description:"montage-native ==============",bugs:{url:"https://github.com/montagejs/native/issues"},_id:"native@0.1.1-alpha",dist:{shasum:"05fd0bed54f49ca37c8d08307b3cc2c0510b47b5"},_from:"native@0.1.1-alpha",_resolved:"https://registry.npmjs.org/native/-/native-0.1.1-alpha.tgz",directories:{lib:"./"},hash:"bbf3eb6",mappings:{montage:{name:"montage",hash:"c827d65",location:"../montage@c827d65/"}},production:!0,useScriptInjection:!0}}),montageDefine("e0871b3","ui/facadeflow.reel/facadeflow.html",{text:'<!DOCTYPE html>\n\n<html>\n    <head>\n        <meta http-equiv=content-type content="text/html; charset=utf-8">\n        <link rel=stylesheet type=text/css href=facadeflow.css>\n        <script type=text/montage-serialization>{"flow":{"prototype":"montage/ui/flow.reel","properties":{"element":{"#":"flow"},"isSelectionEnabled":false,"cameraFov":36.99,"cameraTargetPoint":[0,0,0],"stride":1},"bindings":{"contentController":{"<-":"@owner.buttonController"}}},"image":{"prototype":"ui/image.reel","properties":{"element":{"#":"image"}},"bindings":{"src":{"<-":"@flow.objectAtCurrentIteration.posters.detailed"}}},"details":{"prototype":"ui/details.reel","properties":{"element":{"#":"details"}},"bindings":{"data":{"<-":"@owner.selectedMovie"}}},"owner":{"properties":{"element":{"#":"facade-flow"}},"bindings":{"scroll":{"<-":"@flow.scroll"}}}}</script>\n    </head>\n\n    <body>\n        <div data-montage-id=facade-flow class=facade-flow>\n            <div data-montage-id=flow class="flow flow-fade-out" style="width: 1024px; height: 420px">\n                <div data-montage-id=image class=Image></div>\n            </div>\n            <div class=film></div>\n            <div data-montage-id=details class="details details-fade-out"></div>\n        </div>\n    </body>\n\n</html>'}),montageDefine("e0871b3","ui/details.reel/details",{dependencies:["montage/core/core","montage/ui/component"],factory:function(e,t){var n=e("montage/core/core").Montage,r=e("montage/ui/component").Component;t.Details=n.create(r,{_data:{value:null},data:{set:function(e){this._data=e,this.needsDraw=!0},get:function(){return this._data}},draw:{value:function(){if(this.data){var e=this.data.ratings.audience_rating,t=this.data.ratings.critics_rating;this.aImage.style.backgroundPosition="Fresh"==e?"0px 0px":"Rotten"==e?"0px -25px":"Certified Fresh"==e?"0px -50px":"Upright"==e?"0px -75px":"Spilled"==e?"0px -125px":"0px -100px",this.cImage.style.backgroundPosition="Fresh"==t?"0px 0px":"Rotten"==t?"0px -25px":"Certified Fresh"==t?"0px -50px":"Upright"==t?"0px -75px":"Spilled"==t?"0px -125px":"0px -100px"}}},handleRentButtonAction:{value:function(){window.open(this.data.links.alternate)}},handleTrailerButtonAction:{value:function(){this.dispatchEventNamed("openTrailer",!0,!0,this.data.title)}}})}}),montageDefine("e0871b3","ui/moviepopup.reel/moviepopup",{dependencies:["montage","montage/ui/component"],factory:function(e,t){var n=e("montage").Montage,r=e("montage/ui/component").Component;t.Moviepopup=n.create(r,{TRAILER_URL:{value:"http://www.youtube.com/embed/%s"},player:{value:null},opening:{value:!1},handleCloseButtonAction:{value:function(){this.close()}},openTrailer:{value:function(e){this.player.src=this.TRAILER_URL.replace("%s",e),this.open()}},open:{value:function(){this.opening=!0,this.needsDraw=!0}},close:{value:function(){this.player.src=null,this.closing=!0,this.needsDraw=!0}},draw:{value:function(){this.opening?(this.element.classList.add("moviepopup-open"),this.opening=!1):this.closing&&(this.element.classList.remove("moviepopup-open"),this.closing=!1)}}})}}),montageDefine("e0871b3","ui/image.reel/image.html",{text:'<!DOCTYPE html>\n\n<html>\n<head>\n    <script type=text/montage-serialization>{"owner":{"prototype":"ui/image.reel","properties":{"element":{"#":"Image"}}}}</script>\n</head>\n<body>\n    <div data-montage-id=Image class=Image></div>\n</body>\n</html>'});
bundleLoaded("index.html.bundle-1-0.js")